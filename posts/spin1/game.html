<!-- game.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Spin & Win — EarnYou</title>

 <!-- ✅ Favicon -->
<link rel="icon" type="image/png" href="unnamed.jpg">

   <!-- ✅ SEO Meta Tags -->
<meta name="description" content="Play the Flappy EarnYou Game — a fun and free online flying bird challenge! Tap to fly, dodge pipes, and earn redeem codes when you reach high scores.">
<meta name="keywords" content="Flappy EarnYou, spin and win game, spin game, earning game, flappy bird game, play flappy bird online, earnyou game, browser flappy bird, fun flying game, tap to fly, flappy challenge, redeem code game, best browser games">
<meta name="author" content="EarnYou Games">
<meta name="robots" content="index, follow">
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8MFM0GF7FY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8MFM0GF7FY');
</script>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <div class="container">
    <!-- Navbar -->
    <header class="navbar">
      <a class="brand" href="game.html"><div class="logo">EY</div><h1>EarnYou</h1></a>
      <div class="nav-actions">
        <button class="btn" onclick="location.href='history.html'">History</button>
        <button class="btn primary" onclick="location.href='redeem.html'">Redeem</button>
      </div>
    </header>

    <!-- Game Area -->
    <div class="game-wrap">
      <!-- left: spinner -->
      <section class="card spinner-frame">
        <div style="width:100%;display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="small">Points: <strong id="points">0</strong></div>
            <div class="small">Spins today: <strong id="spins-used">0</strong> / 20</div>
          </div>
          <div class="small">Daily limit: 20</div>
        </div>

        <div style="position:relative;margin-top:6px">
          <div class="pointer" aria-hidden></div>

          <div class="wheel-wrap">
            <div id="wheel" class="wheel" aria-hidden></div>
            <div class="center">
              <button id="spinBtn" class="spin-btn">SPIN</button>
            </div>
          </div>
        </div>

        <div class="center-txt small" style="margin-top:8px">Rewards: 5, 9, 10, 15, 20 points</div>
      </section>

      <!-- right: status & history quick -->
      <aside>
        <div class="card status">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <h3 style="margin:0">Status</h3>
            <div class="small">EarnYou Spin</div>
          </div>

          <div class="stat"><span>Points</span><strong id="points2">0</strong></div>
          <div class="stat"><span>Spins today</span><strong id="spins-used2">0 / 20</strong></div>
          <div class="stat"><span>Last win</span><strong id="last-win">—</strong></div>

          <div style="margin-top:10px">
            <button class="btn" onclick="location.href='redeem.html'">Redeem Points</button>
          </div>

          <div style="margin-top:16px">
            <h4 style="margin:0 0 8px 0">Recent Requests</h4>
            <div id="recent-history" class="history-list">
              <!-- populated by JS -->
            </div>
          </div>
        </div>
      </aside>
    </div>

  </div>

  <div id="toast" class="toast hidden"></div>

  <script>
  /* game.js embedded for simplicity - all in front-end */
  (function(){
    // Config
    const REWARDS = [5,9,8,15,18]; // sectors
    const DAILY_LIMIT = 20;

    // LocalStorage keys
    const KEY_POINTS = 'sw_points';
    const KEY_SPINS = 'sw_spins';
    const KEY_SPIN_DATE = 'sw_spin_date';
    const KEY_HISTORY = 'sw_history'; // redeem requests list

    // Elements
    const pointsEl = document.getElementById('points');
    const pointsEl2 = document.getElementById('points2');
    const spinsEl = document.getElementById('spins-used');
    const spinsEl2 = document.getElementById('spins-used2');
    const lastWinEl = document.getElementById('last-win');
    const recentEl = document.getElementById('recent-history');
    const spinBtn = document.getElementById('spinBtn');
    const wheel = document.getElementById('wheel');
    const toast = document.getElementById('toast');

    // build wheel sectors visually
    function buildWheel(){
      wheel.innerHTML = '';
      const segCount = REWARDS.length;
      const angle = 360 / segCount;
      for(let i=0;i<segCount;i++){
        const sector = document.createElement('div');
        sector.className = 'sector';
        sector.style.transform = 'rotate(' + (i*angle) + 'deg)';
        const seg = document.createElement('div');
        seg.className = 'seg';
        seg.style.width = '200%';
        seg.style.height = '200%';
        seg.style.background = (i%2===0) ? 'conic-gradient(var(--accent), transparent)' : 'linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01))';
        seg.style.color = (i%2===0)?'#071021':'#e6eef8';
        seg.style.paddingLeft = '24px';
        seg.style.fontSize = '20px';
        seg.textContent = REWARDS[i] + ' pts';
        sector.appendChild(seg);
        wheel.appendChild(sector);
      }
    }

    // utilities: storage get/set with defaults
    function getPoints(){ return parseInt(localStorage.getItem(KEY_POINTS) || '0',10); }
    function setPoints(v){ localStorage.setItem(KEY_POINTS, String(v)); updateUI(); }
    function getSpins(){ 
      // reset spins each new day
      const today = new Date().toISOString().slice(0,10);
      const d = localStorage.getItem(KEY_SPIN_DATE);
      if(d !== today){ localStorage.setItem(KEY_SPIN_DATE, today); localStorage.setItem(KEY_SPINS, '0'); return 0; }
      return parseInt(localStorage.getItem(KEY_SPINS) || '0',10);
    }
    function incSpins(){ const s = getSpins()+1; localStorage.setItem(KEY_SPINS, String(s)); updateUI(); return s; }
    function resetLocal(){ if(confirm('Reset local data?')){ localStorage.removeItem(KEY_POINTS); localStorage.removeItem(KEY_SPINS); localStorage.removeItem(KEY_SPIN_DATE); localStorage.removeItem(KEY_HISTORY); updateUI(); showToast('Local data reset'); } }

    function getHistory(){ return JSON.parse(localStorage.getItem(KEY_HISTORY) || '[]'); }
    function saveHistory(arr){ localStorage.setItem(KEY_HISTORY, JSON.stringify(arr)); }

    function updateUI(){
      const pts = getPoints();
      const spins = getSpins();
      pointsEl.textContent = pts;
      pointsEl2.textContent = pts;
      spinsEl.textContent = spins;
      spinsEl2.textContent = spins + ' / ' + DAILY_LIMIT;
      const hist = getHistory();
      lastWinEl.textContent = (hist.length && hist[hist.length-1].points) ? (hist[hist.length-1].points + ' pts') : '—';
      // show recent 3
      recentEl.innerHTML = '';
      const recent = hist.slice(-3).reverse();
      recent.forEach(h=>{
        const div = document.createElement('div');
        div.className='history-item';
        div.innerHTML = '<div style="display:flex;justify-content:space-between"><strong>'+(h.type||'Redeem')+'</strong><span class="small">'+(new Date(h.requestedAt).toLocaleString())+'</span></div>'
          + '<div class="small">Status: ' + (h.status==='pending'?'<span class="badge pending">Pending</span>':'<span class="badge done">Redeemed</span>') + '</div>';
        recentEl.appendChild(div);
      });
    }

    // toast
    function showToast(txt,tm=2500){
      toast.textContent = txt; toast.classList.remove('hidden');
      setTimeout(()=> toast.classList.add('hidden'), tm);
    }

    // Spin logic: choose random reward, animate wheel to land there
    let spinning = false;
    function spin(){
      if(spinning) return;
      const spins = getSpins();
      if(spins >= DAILY_LIMIT){ showToast('Daily spin limit reached'); return; }
      spinning = true;
      spinBtn.disabled = true;

      // pick a reward randomly (equal prob)
      const idx = Math.floor(Math.random()*REWARDS.length);
      const reward = REWARDS[idx];

      // compute rotation: we want wheel to end with sector idx at pointer (pointer at top)
      const segAngle = 360 / REWARDS.length;
      // random offset inside sector for realism
      const sectorStart = idx * segAngle;
      const offset = Math.random() * (segAngle - 8) + 4; // avoid edges
      const finalAngle = 360*8 + (360 - (sectorStart + offset)); // spin multiple rounds + land
      wheel.style.transition = 'transform 4s cubic-bezier(.17,.9,.3,1)';
      wheel.style.transform = 'rotate(' + finalAngle + 'deg)';

      // after animation finishes:
      setTimeout(()=> {
        // normalize rotation to small angle (so future spins ok)
        wheel.style.transition = 'none';
        const normalized = finalAngle % 360;
        wheel.style.transform = 'rotate(' + normalized + 'deg)';
        // award points
        const newPoints = getPoints() + reward;
        setPoints(newPoints);
        const s = incSpins();
        // save a small history entry (not redeem) to show last win
        const hist = getHistory();
        hist.push({ id: 'win_' + Date.now(), type: 'Win', points: reward, requestedAt: new Date().toISOString(), status: 'done' });
        saveHistory(hist);
        showToast('You won ' + reward + ' points!');
        spinning = false;
        spinBtn.disabled = false;
        updateUI();
      }, 4200);
    }

    // Initialize
    buildWheel();
    updateUI();

    // attach
    spinBtn.addEventListener('click', spin);
    // also allow spacebar to spin
    window.addEventListener('keydown', (e)=>{ if(e.code==='Space'){ e.preventDefault(); spin(); }});
    // expose resetLocal for button
    window.resetLocal = resetLocal;

  })();
  </script>
</body>
</html>



